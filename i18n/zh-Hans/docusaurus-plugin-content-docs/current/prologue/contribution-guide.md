---
title: è´¡çŒ®æŒ‡å—
sidebar_position: 20
---

æœ‰å¤šç§æ–¹å¼å‚ä¸ nature çš„è´¡çŒ®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæäº¤ BUGã€åˆ†äº«æƒ³æ³•ã€ç¤¾åŒºè®¨è®ºã€ç¼–ç å‚ä¸ã€æ–‡æ¡£æ”¹è¿›ã€è§„èŒƒåˆ¶å®šã€èµ„æ–™è´¡çŒ®ã€æèµ ç­‰ã€‚

:::tip
ğŸ‰ nature ç¤¾åŒºå¯ç”¨ç‰ˆæœ¬å³å°†å‘å¸ƒï¼Œé‚€ä½ ä¸€èµ·æ„å»ºæ ‡å‡†åº“ï¼Œç›¸å…³æ ‡å‡†åº“éƒ½ä¼šåˆå¹¶è‡³ nature ä¸»ä»“åº“ã€‚
:::

## é”™è¯¯ä¸å»ºè®®

å¦‚æœä½ å¸Œæœ›æäº¤é”™è¯¯æŠ¥å‘Šï¼Œä½ çš„é—®é¢˜åº”åŒ…å«æ ‡é¢˜å’Œæ¸…æ™°çš„é—®é¢˜æè¿°ã€‚ä½ è¿˜åº”å°½å¯èƒ½æä¾›ç›¸å…³ä¿¡æ¯å’Œæ¼”ç¤ºé—®é¢˜çš„ä»£ç ç¤ºä¾‹ã€‚é”™è¯¯æŠ¥å‘Šçš„ç›®çš„æ˜¯ä½¿è‡ªå·±å’Œå…¶ä»–äººèƒ½å¤Ÿè½»æ¾åœ°é‡ç°é”™è¯¯å¹¶å¼€å‘ä¿®å¤ç¨‹åºã€‚

æäº¤å»ºè®®æ—¶å°½é‡é˜è¿°æ¸…æ¥šè‡ªå·±çš„æƒ³æ³•ï¼Œæœ€å¥½å¸¦ä¸Šæœ‰è¯´æœåŠ›çš„èµ„æ–™ï¼Œè®©ä½ å»ºè®®èƒ½å¤Ÿå¾—åˆ°æ›´å¥½çš„é‡‡çº³ã€‚æ— è®ºæ˜¯è¯­æ³•ï¼Œç¼–è¯‘å™¨è®¾è®¡ï¼Œç¼–ç è§„èŒƒï¼Œå­¦ä¹ èµ„æ–™ç­‰ç­‰éƒ½å¸Œæœ›å¤§å®¶èƒ½å¤Ÿæä¾›å»ºè®®ã€‚

ä½ å¯ä»¥é€šè¿‡ issue æ¥æäº¤ä½ çš„é”™è¯¯æŠ¥å‘Šæˆ–è€…å»ºè®® [nature-lang/nature](https://github.com/nature-lang/nature/issues)

å¯¹äºåŠŸèƒ½æ”¹è¿›ä¸å¼€å‘è´¡çŒ®ï¼Œè¯·åŠ¡å¿…å…ˆé€šè¿‡ issue è¿›è¡Œæ²Ÿé€šï¼Œé€šè¿‡åå°†ä¼šä¸ºè¯¥ issue æ‰“ä¸Šç›¸å…³ tagï¼Œæ­¤æ—¶ä½ å¯ä»¥å®‰å¿ƒçš„è¿›è¡Œä»£ç å¼€å‘è€Œä¸è¦æ‹…å¿ƒå†²çªé—®é¢˜ã€‚

## ç¤¾åŒºäº¤æµ

æƒ³æ³•å’Œé—®é¢˜æ¨èä½¿ç”¨ github issue è¿›è¡Œè®¨è®ºè®©æ›´å¤šäººèƒ½å¤Ÿå…³æ³¨å¹¶å‚ä¸ã€‚

å¾®ä¿¡ç¾¤: æ·»åŠ å¾®ä¿¡å· `nature-lang` å¤‡æ³¨ â€œç”³è¯·åŠ ç¾¤â€

github è®¨è®ºç¤¾åŒº: [https://github.com/nature-lang/nature/discussions](https://github.com/nature-lang/nature/discussions)

## æºç ç¼–è¯‘

ç›®å½•ç»“æ„

```shell
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ VERSION # ç‰ˆæœ¬å·ï¼Œéµå®ˆè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ
â”œâ”€â”€ cmake # cmake æ„å»ºç›¸å…³æ–‡ä»¶
â”œâ”€â”€ cmd # cmd å¦‚ nature build å…¥å£æ–‡ä»¶
â”œâ”€â”€ config # ç¼–è¯‘æ—¶é…ç½®
â”œâ”€â”€ lib # ç¼–è¯‘ nature æºæ–‡ä»¶ä»¥åŠæ‰“åŒ… nature å®‰è£…åŒ…æ—¶å¼•ç”¨åº“æ–‡ä»¶
â”œâ”€â”€ main.c # å…¥å£
â”œâ”€â”€ runtime # runtime æºç ä»£ç 
â”œâ”€â”€ src # ç¼–è¯‘å™¨æºç 
â”œâ”€â”€ std # æ ‡å‡†åº“
â”œâ”€â”€ tests # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ utils # å·¥å…·å‡½æ•°
```

ç¼–è¯‘ runtime

> ç›®å‰ runtime åªæœ‰ linux-amd64 ç›®æ ‡å¹³å°ï¼Œæ‰€ä»¥åªéœ€è¦ç¼–è¯‘ä¸€æ¬¡ï¼Œæ„å»ºå®Œæˆåä¼šå†™å…¥åˆ° lib/linux-amd64 ç›®å½•ä¸‹çš„ libruntime.a æ–‡ä»¶ã€‚ç¼–è¯‘ nature æ—¶ä¼šå°†è¯¥ç›®å½•å®‰è£…åˆ°æŒ‡å®šä½ç½®ã€‚

```shell
cmake -B build-runtime -S runtime -DCMAKE_TOOLCHAIN_FILE=$(pwd)/cmake/linux-amd64-toolchain.cmake -DCMAKE_BUILD_TYPE=Release

cmake --build build-runtime --target runtime
```

ç¼–è¯‘ nature

:::info
linux-amd64-toolchain.cmake ä½¿ç”¨äº† musl-gcc è¿›è¡Œé™æ€ç¼–è¯‘ï¼Œæ¨èé™æ€ç¼–è¯‘ã€‚
å¦‚æœæƒ³è¦ç¼–è¯‘ darwin/amd64 æ›´æ¢å·¥å…·é“¾ä¸º darwin-amd64-toolchain.cmake å³å¯
:::info

```shell
# mkdir -p release && mkdir -p build-release
cmake -B build-release -DCMAKE_TOOLCHAIN_FILE=$(pwd)/cmake/linux-amd64-toolchain.cmake -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_BUILD_TYPE=Release -DCPACK_OUTPUT_FILE_PREFIX=$(pwd)/release

# build
cmake --build build-release

# test
cmake --build build-release --target test

# install é»˜è®¤å®‰è£…åˆ° /usr/local/nature ç›®å½•ä¸‹
cmake --build build-release --target install

# æ‰“åŒ…
cmake --build build-release --target package
```

## ç›¸å…³èµ„æ–™

ä¸»è¦æ˜¯æˆ‘å­¦ä¹ ç¼–è¯‘åŸç†ä»¥åŠç¼–å†™ nature æ—¶çš„ä¸€äº›èµ„æ–™ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ å‚ä¸è´¡çŒ®ã€‚ (æŒ‰å­¦ä¹ çš„å…ˆåé¡ºåºç²—ç•¥æ•´ç†)

1. sicp (æœ‰ python å’Œ js ç‰ˆæœ¬)ï¼Œæ¨èå’Œè§†é¢‘ä¸€èµ·è§‚çœ‹ã€‚
2. ç¼–è¯‘å™¨è®¾è®¡(ç¬¬äºŒç‰ˆ)ï¼Œéƒ¨åˆ†ç« èŠ‚ï¼Œæ¨èçœ‹è‹±æ–‡ç‰ˆï¼Œä¸­æ–‡ç‰ˆå®åœ¨æ˜¯çœ‹ä¸æ‡‚ã€‚
3. ç°ä»£ç¼–è¯‘åŸç† â€”â€” C è¯­è¨€æè¿°ï¼Œéƒ¨åˆ†ç« èŠ‚ï¼Œä¸»è¦æ˜¯ ssa éƒ¨åˆ†ã€‚
4. [crafting interpreters](https://craftinginterpreters.com/) éå¸¸æ¨è
5. è‡ªå·±åŠ¨æ‰‹æ„é€ ç¼–è¯‘ç³»ç»Ÿ â€”â€” ç¼–è¯‘ã€æ±‡ç¼–ã€ä¸è¿æ¥ï¼Œä¸»è¦çœ‹äº†æ±‡ç¼–éƒ¨åˆ†
6. Linear Scan Register Allocation for the Java HotSpotTM Client Compilerï¼Œçº¿æ€§æ‰«æå¯„å­˜å™¨åˆ†é…åŸºäºè¯¥è®ºæ–‡ç¼–å†™
7. Linear Scan Register Allocation on SSA Formï¼Œssa å½¢å¼çº¿æ€§æ‰«æå¯„å­˜å™¨åˆ†é…
8. [Writing a Memory Allocator](http://dmitrysoshnikov.com/compilers/writing-a-memory-allocator/) å†…å­˜åˆ†é…ä¸åƒåœ¾å›æ”¶è¯¾ç¨‹
9. golang/tcmallocï¼Œå†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶å®ç°ä¸Šå‚è€ƒï¼Œä¸è¿‡æˆ‘æºç é˜…è¯»èƒ½åŠ›æœ‰é™ï¼Œæ‰€ä»¥çœ‹çš„éƒ½æ˜¯æ–‡ç« è§£æã€‚
10. [bspaans/jit-compiler](https://github.com/bspaans/jit-compiler) æ±‡ç¼–å™¨éƒ¨åˆ†å‚è€ƒå®ç°ï¼Œå…·ä½“æŒ‡ä»¤ç¼–ç å‚è€ƒ intel æ‰‹å†Œç¬¬äºŒå·
11. ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€”â€”é“¾æ¥è£…è½½ä¸åº“ï¼Œå­¦ä¹ è¿æ¥å™¨ä¸ ELF æ–‡ä»¶æ„æˆ
12. [Tiny C Compiler](https://bellard.org/tcc/) è¿æ¥å™¨éƒ¨åˆ†å‚è€ƒå®ç°

## ç¼–ç è§„èŒƒ

nature æºä»£ç åŸºäº ANSI C11 å’Œ musl libc è¿›è¡Œå¼€å‘ã€‚

1. æºç ä¸Šè¿½æ±‚ç®€å•å¯è¯»ï¼Œä¸ä½¿ç”¨å¤æ‚çš„ç¬¬ä¸‰æ–¹åº“
2. æ–‡ä»¶å/ç›®å½•å/å…³é”®å­—é‡‡ç”¨å°å†™ + ä¸‹åˆ’çº¿åˆ†è¯ï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯å®å®šä¹‰ä½¿ç”¨å¤§å†™ + ä¸‹åˆ’çº¿åˆ†è¯ã€‚
3. ç›¸å…³çš„åŠŸèƒ½æ”¹è¿›ä¸ bug ä¿®å¤éœ€è¦æä¾› ctest æµ‹è¯•ç”¨ä¾‹ï¼Œç›¸å…³æµ‹è¯•ç”¨ä¾‹éƒ½æ”¾åœ¨ `tests/blackbox` ç›®å½•ä¸­ 
